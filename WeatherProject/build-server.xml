<?xml version="1.0" encoding="UTF-8"?>
<project name="WeatherProject-Server" default="server-jar" basedir=".">
    <import file="build.xml" />
    <target name="server-init">
        <property name="storage.mainclass" value="weather.serverside.storage.StorageServerMainProgram" />
        <property name="retrieval.mainclass" value="weather.serverside.retrieval.RetrievalServer" />
        <property name="movie.mainclass" value="weather.serverside.movie.MovieMakerServer" />
        <property name="watchdog.mainclass" value="weather.serverside.watchdog.ServerWatchdogService" />
        <property name="grading.mainclass" value="weather.serverside.servergrading.ServerGradingProgram" />
        <property name="oldvideo.mainclass" value="weather.serverside.old_day_long_maker.OldMovieMakerMainProgram" />
        <property name="oldstation.mainclass" value="weather.serverside.old_weather_underground_retrieval.OldWeatherUndergroundFileRetrieverMainProgram" />
    </target>
    
    <!-- Always clean, so fresh build for installers -->
    <target name="server-jar" depends="clean,jar,server-init">
        <!-- Build Server Jars -->
        
        <!-- Build Storage Server Jar -->
        <jar jarfile="${dist.dir}/Storage.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${storage.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
        <!-- Build Retrieval Server Jar -->
        <jar jarfile="${dist.dir}/Retrieval.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${retrieval.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
        <!-- Build Movie Server Jar -->
        <jar jarfile="${dist.dir}/Movie.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${movie.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
        <!-- Build Server Watchdog Jar -->
        <jar jarfile="${dist.dir}/ServerWatchdog.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${watchdog.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
        <!-- Build Server Grading Jar -->
        <jar jarfile="${dist.dir}/GradingSystem.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${grading.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
        <!-- Build Jar To Make Old Videos -->
        <jar jarfile="${dist.dir}/OldVideoMaker.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${oldvideo.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
        <!-- Build Jar To Retrieve Old Weather Underground Data -->
        <jar jarfile="${dist.dir}/OldStationDataRetriever.jar" basedir="${build.dir}/classes">
            <exclude name="${testideas.dir}" />
            <exclude name="${installer.dir}" />
            <manifest>
                <attribute name="Main-Class" value="${oldstation.mainclass}" />
                <attribute name="Class-Path" value="${jar.classpath}" />
                <attribute name="Ant-Version" value="Apache Ant 1.7.0"/>
            </manifest>
        </jar>
        
    </target>
</project>
